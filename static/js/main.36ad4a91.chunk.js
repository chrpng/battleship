(this["webpackJsonpodin-battleship"]=this["webpackJsonpodin-battleship"]||[]).push([[0],{22:function(e,t,r){e.exports=r(33)},27:function(e,t,r){},29:function(e,t,r){},30:function(e,t,r){},31:function(e,t,r){},33:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(17),i=r.n(o),c=(r(27),r(12)),l=r.n(c),u=r(18),s=r(3),d=(r(29),r(30),r(37));r(31);var f=function(e){var t=e.val,r=e.coord,n=e.handleCellClick,o=Object(s.a)(r,2),i=o[0],c=o[1],l=c+1,u={gridRowStart:"".concat(i+1),gridRowEnd:"span 1",gridColumnStart:"".concat(l),gridColumnEnd:"span 1"},d="H"===t?"cell-x hit":"M"===t?"cell-x":"",f="H"===t||"M"===t?"X":null;return a.a.createElement("li",{className:"cell ".concat(d),onClick:n,"data-row":i,"data-col":c,style:u},f)},h=r(36);var g=function(e){var t=e.coord,r=e.length,n=e.isHorizontal,o=t.row,i=t.col,c=Object(h.a)({item:{type:"ship",row:o,col:i},collect:function(e){return{isDragging:!!e.isDragging()}}}),l=Object(s.a)(c,2),u=l[0].isDragging,d=l[1],f=o+1,g={background:"#39bdf1",border:"2px solid #0000FF",gridColumnStart:"".concat(i+1),gridRowStart:"".concat(f),opacity:u?.2:.4};return g.gridColumnEnd=n?"span ".concat(r):"span 1",g.gridRowEnd=n?"span 1":"span ".concat(r),a.a.createElement("div",{ref:d,className:"ship",style:g})};var m=function(e){var t=e.playerBoard,r=e.handleCellClick,o=e.ships,i=Object(n.useContext)(E),c=i.movePlayer1Board,l=i.canMovePlayer1Board,u=i.isStart,h=i.isPlayer1Turn,m=Object(d.a)({accept:"ship",canDrop:function(e,t){var r=t.getDifferenceFromInitialOffset(),n=v(e.row,e.col,r),a=n.toRow,o=n.toCol;return!u&&l(e.row,e.col,a,o)},drop:function(e,t){console.log(e);var r=t.getDifferenceFromInitialOffset(),n=v(e.row,e.col,r),a=n.toRow,o=n.toCol;c(e.row,e.col,a,o)}}),p=Object(s.a)(m,2)[1],v=function(e,t,r){var n=r.x,a=r.y;return{toRow:e+Math.round(a/40),toCol:t+Math.round(n/40)}};return a.a.createElement("ul",{className:"board-grid ".concat(o?"":"enemy"," ").concat(u&&h?"can-attack":""),ref:p},o?o.map((function(e,t){return a.a.createElement(g,{key:t,coord:e.getShipCoordsArr()[0],length:e.length,isHorizontal:e.isHorizontal})})):null,t?t.map((function(e,t){return e.map((function(e,n){return a.a.createElement(f,{key:"r".concat(t,"c").concat(n),coord:[t,n],handleCellClick:r,val:e})}))})):null)},p=function(e,t,r,n){for(var a=[],o=0;o<r;o++)n?a.push({row:e,col:t+o}):a.push({row:e+o,col:t});return a},v=function(e,t,r,n){for(var a=[],o=-1;o<r+1;o++)n?(-1!==o&&o!==r||a.push({row:e,col:t+o}),a.push({row:e-1,col:t+o}),a.push({row:e+1,col:t+o})):(-1!==o&&o!==r||a.push({row:e+o,col:t}),a.push({row:e+o,col:t-1}),a.push({row:e+o,col:t+1}));return a};var b=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=r,o=p(e,t,r,n),i=v(e,t,r,n),c=function(){return o},l=function(){return i},u=function(){a--},s=function(){return a<=0};return{getShipCoordsArr:c,getShipAdjacentArr:l,get length(){return r},get isHorizontal(){return n},hit:u,isSunk:s}};var S=function(e){var t=function(e){for(var t=[],r=0;r<e;r++){t.push([]);for(var n=0;n<e;n++)t[r].push("")}return t}(10),r=[],n=[{quantity:1,length:4},{quantity:2,length:3},{quantity:3,length:2},{quantity:4,length:1}],a=function(e,t){return r.find((function(r){return r.getShipCoordsArr().some((function(r){return r.row===e&&r.col===t}))}))},o=function(e){return e.filter((function(e){return i(e.row)&&i(e.col)}))},i=function(e){return e>=0&&e<10},c=function(e,t,r){return e.map((function(e){return{row:e.row+t,col:e.col+r}}))},l=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=b(e,n,a,o),c=s(i,e,n);if(!c)return!1;r.push(i);for(var l=0;l<a;l++)o?t[e][n+l]="S":t[e+l][n]="S";return!0},u=function(e){e.getShipCoordsArr().forEach((function(e){t[e.row][e.col]=""}))},s=function(e,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=r+a,s=n+l,d=i(u)&&i(s),f=e.isHorizontal?s+e.length<=10:u+e.length<=10;if(!d||!f)return!1;var h=e.getShipCoordsArr(),g=e.getShipAdjacentArr(),m=c(h,a,l),p=c(g,a,l),v=m.every((function(e){return""===t[e.row][e.col]})),b=o(p),S=b.every((function(e){return""===t[e.row][e.col]}));return v&&S},d=function(){r=[],t=t.map((function(e){return e.map((function(e){return""}))}))};return{get name(){return e},getBoardSize:function(){return 10},placeNewShip:l,moveShip:function(e,t,n){u(e),r=r.filter((function(t){return t!==e})),l(t,n,e.length,e.isHorizontal)},canMoveShip:function(e,r,n,a,o){u(e);var i=s(e,r,n,a-r,o-n);return function(e){e.getShipCoordsArr().forEach((function(e){t[e.row][e.col]="S"}))}(e),i},getBoard:function(){return t},getShips:function(){return r},getShip:a,randomizeShips:function(){d(),n.forEach((function(e){for(var t=0;t<e.quantity;t++){var r=void 0,n=void 0,a=void 0,o=void 0;do{r=Math.floor(10*Math.random()),n=Math.floor(10*Math.random()),a=Math.random()>.5,o=l(r,n,e.length,a)}while(!o)}}))},receiveAttack:function(e,r){var n,c,l=parseInt(e),u=parseInt(r);if(!i(l)||!i(u))return{isValid:!1,isHit:!1};switch(t[l][u]){case"S":t[l][u]="H";var s=a(l,u);if(s&&s.hit(),s.isSunk()){var d=s.getShipAdjacentArr();o(d).forEach((function(e){t[e.row][e.col]="M"}))}n=!0,c=!0;break;case"":t[l][u]="M",n=!0,c=!1;break;default:console.log("cannot attack same location again"),n=!1,c=!1}return{isValid:n,isHit:c}},areAllShipsSunk:function(){return r.every((function(e){return e.isSunk()}))}}};var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Player 1",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=t?e:"CPU",a=S(n),o=function(e,t,r){return e.receiveAttack(t,r)},i=function(e){var t,n,a;do{if(r.length>0){var o=r.pop();n=o.row,a=o.col}else n=Math.floor(Math.random()*e.getBoardSize()),a=Math.floor(Math.random()*e.getBoardSize());t=e.receiveAttack(n,a)}while(!1===t.isValid);return t.isHit&&(r.push({row:n-1,col:a}),r.push({row:n+1,col:a}),r.push({row:n,col:a-1}),r.push({row:n,col:a+1})),t},c=t?o:i;return{get gameboard(){return a},get name(){return n},attack:c}},k=r(35),y=r(20),E=Object(n.createContext)(),C=w("Juan",!0),j=w();var O=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),r=t[0],o=t[1],i=Object(n.useState)([]),c=Object(s.a)(i,2),d=c[0],f=c[1],h=Object(n.useState)([]),g=Object(s.a)(h,2),p=g[0],v=g[1],b=Object(n.useState)(!1),S=Object(s.a)(b,2),w=S[0],O=S[1],B=Object(n.useState)(!1),M=Object(s.a)(B,2),A=M[0],z=M[1],H=Object(n.useState)(!1),x=Object(s.a)(H,2),N=x[0],P=x[1];Object(n.useEffect)((function(){C.gameboard.randomizeShips(),o(C.gameboard.getBoard()),v(C.gameboard.getShips()),j.gameboard.randomizeShips(),f(j.gameboard.getBoard()),O(!0)}),[]),Object(n.useEffect)((function(){D(C.gameboard)}),[w]);var R=function(e,t,r){if(!N&&A&&w){var n=C.attack(e,t,r);if(!n.isValid)return;f(e.getBoard().slice()),e.areAllShipsSunk()&&P(!0),n.isHit||N||O(!1)}},D=function(){var e=Object(u.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N||!A||w){e.next=8;break}case 1:return e.next=3,new Promise((function(e){setTimeout((function(){e(j.attack(t))}),500)}));case 3:r=e.sent,o(t.getBoard().slice()),t.areAllShipsSunk()&&P(!0);case 6:if(!N&&r.isHit){e.next=1;break}case 7:N||O(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=N?w?"Player 1 Wins!":"Player 2 Wins!":A?w?"Your Move":"Their Move":"Set your board...",I=d?a.a.createElement("section",{className:"boards-flex"},a.a.createElement(m,{playerBoard:r,ships:p}),a.a.createElement("div",{className:"middle-console"},A?a.a.createElement("button",{onClick:function(){C.gameboard.randomizeShips(),o(C.gameboard.getBoard()),v(C.gameboard.getShips()),j.gameboard.randomizeShips(),f(j.gameboard.getBoard()),O(!0),z(!1),P(!1)}},"New Game"):a.a.createElement("button",{className:"start-btn",onClick:function(){return z(!0)}},"Start"),a.a.createElement("button",{className:A?"disabled":"",onClick:function(){A||(C.gameboard.randomizeShips(),o(C.gameboard.getBoard()),v(C.gameboard.getShips()))}},"Randomize"),a.a.createElement("div",{className:"game-text"},q)),a.a.createElement(m,{playerBoard:d,handleCellClick:function(e){R(j.gameboard,e.target.dataset.row,e.target.dataset.col)}})):"loading...";return a.a.createElement(E.Provider,{value:{movePlayer1Board:function(e,t,r,n){var a=C.gameboard.getShip(e,t);C.gameboard.moveShip(a,r,n),v(C.gameboard.getShips()),o(C.gameboard.getBoard())},canMovePlayer1Board:function(e,t,r,n){var a=C.gameboard.getShip(e,t);return C.gameboard.canMoveShip(a,e,t,r,n)},isStart:A,isPlayer1Turn:w}},a.a.createElement(k.a,{backend:y.a},a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("h1",null,"Battleship")),a.a.createElement("main",null,I))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.36ad4a91.chunk.js.map